import{_ as Ft,b as Ae}from"../chunks/CjPccBOC.js";import{b as Te,e as jt,i as Rt,r as rt,c as Zt,s as V,f as z,d as G,g as De}from"../chunks/Div0rsmZ.js";import"../chunks/DsnmJJEf.js";import{o as ue,a as Fe}from"../chunks/BO8TDW0E.js";import{z as Be,A as Ne,ba as Se,y as Me,D as Oe,a9 as Ve,E as qe,bb as ze,bc as Ge,T as Ye,h as $e,bd as We,be as Ze,bf as He,as as we,bg as Je,V as Ke,n as yt,X as St,Y as R,a1 as o,a2 as a,a3 as r,a4 as Ht,Z as _t,$ as k,a0 as Mt,_ as D,g as e,am as Lt,aR as Nt,aQ as W,s as P,aW as Qe,bh as vt}from"../chunks/Diw6UIRm.js";import{b as Xe,d as Kt,s as N,a as ta,e as ea}from"../chunks/DuK_nuCY.js";import{i as M}from"../chunks/BC6CTdml.js";function me(i,t,n){Be&&Ne();var c=new Oe(i),s=!Se();Me(()=>{var u=t();s&&u!==null&&typeof u=="object"&&(u={}),c.ensure(u,n)})}const aa=()=>performance.now(),tt={tick:i=>requestAnimationFrame(i),now:()=>aa(),tasks:new Set};function ke(){const i=tt.now();tt.tasks.forEach(t=>{t.c(i)||(tt.tasks.delete(t),t.f())}),tt.tasks.size!==0&&tt.tick(ke)}function oa(i){let t;return tt.tasks.size===0&&tt.tick(ke),{promise:new Promise(n=>{tt.tasks.add(t={c:i,f:n})}),abort(){tt.tasks.delete(t)}}}function Bt(i,t){we(()=>{i.dispatchEvent(new CustomEvent(t))})}function sa(i){if(i==="float")return"cssFloat";if(i==="offset")return"cssOffset";if(i.startsWith("--"))return i;const t=i.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(n=>n[0].toUpperCase()+n.slice(1)).join("")}function de(i){const t={},n=i.split(";");for(const c of n){const[s,u]=c.split(":");if(!s||u===void 0)break;const h=sa(s.trim());t[h]=u.trim()}return t}const ia=i=>i;function Wt(i,t,n,c){var s=(i&Ze)!==0,u=(i&He)!==0,h=s&&u,E=(i&We)!==0,w=h?"both":s?"in":"out",d,f=t.inert,T=t.style.overflow,g,y;function B(){return we(()=>d??=n()(t,c?.()??{},{direction:w}))}var b={is_global:E,in(){if(t.inert=f,!s){y?.abort(),y?.reset?.();return}u||g?.abort(),Bt(t,"introstart"),g=Jt(t,B(),y,1,()=>{Bt(t,"introend"),g?.abort(),g=d=void 0,t.style.overflow=T})},out(_){if(!u){_?.(),d=void 0;return}t.inert=!0,Bt(t,"outrostart"),y=Jt(t,B(),g,0,()=>{Bt(t,"outroend"),_?.()})},stop:()=>{g?.abort(),y?.abort()}},v=Ve;if((v.transitions??=[]).push(b),s&&Xe){var m=E;if(!m){for(var l=v.parent;l&&(l.f&qe)!==0;)for(;(l=l.parent)&&(l.f&ze)===0;);m=!l||(l.f&Ge)!==0}m&&Ye(()=>{$e(()=>b.in())})}}function Jt(i,t,n,c,s){var u=c===1;if(Je(t)){var h,E=!1;return Ke(()=>{if(!E){var v=t({direction:u?"in":"out"});h=Jt(i,v,n,c,s)}}),{abort:()=>{E=!0,h?.abort()},deactivate:()=>h.deactivate(),reset:()=>h.reset(),t:()=>h.t()}}if(n?.deactivate(),!t?.duration)return s(),{abort:yt,deactivate:yt,reset:yt,t:()=>c};const{delay:w=0,css:d,tick:f,easing:T=ia}=t;var g=[];if(u&&n===void 0&&(f&&f(0,1),d)){var y=de(d(0,1));g.push(y,y)}var B=()=>1-c,b=i.animate(g,{duration:w,fill:"forwards"});return b.onfinish=()=>{b.cancel();var v=n?.t()??1-c;n?.abort();var m=c-v,l=t.duration*Math.abs(m),_=[];if(l>0){var U=!1;if(d)for(var F=Math.ceil(l/16.666666666666668),C=0;C<=F;C+=1){var S=v+m*T(C/F),p=de(d(S,1-S));_.push(p),U||=p.overflow==="hidden"}U&&(i.style.overflow="hidden"),B=()=>{var L=b.currentTime;return v+m*T(L/l)},f&&oa(()=>{if(b.playState!=="running")return!1;var L=B();return f(L,1-L),!0})}b=i.animate(_,{duration:l,fill:"forwards"}),b.onfinish=()=>{B=()=>c,f?.(c,1-c),s()}},{abort:()=>{b&&(b.cancel(),b.effect=null,b.onfinish=yt)},deactivate:()=>{s=yt},reset:()=>{c===0&&f?.(1,0)},t:()=>B()}}const ra=""+new URL("../assets/bg-00.BGAGFz8T.webp",import.meta.url).href,na=""+new URL("../assets/bg-01.BrBSel-Z.webp",import.meta.url).href,ca=""+new URL("../assets/bg-02.ZI4Quqob.webp",import.meta.url).href,la=""+new URL("../assets/bg-03.8lNxmXEy.webp",import.meta.url).href,ba=""+new URL("../assets/bg-04.B4tJgvPy.webp",import.meta.url).href,va=""+new URL("../assets/bg-05.XCqrNzDV.webp",import.meta.url).href,_a=""+new URL("../assets/bg-06.B2CJF--9.webp",import.meta.url).href,ua=""+new URL("../assets/bg-07.DnFXE2UN.webp",import.meta.url).href,ma=""+new URL("../assets/bg-08.C5H5IlCl.webp",import.meta.url).href,da=""+new URL("../assets/bg-09.DE4eBF9u.webp",import.meta.url).href,ga=""+new URL("../assets/bg-10.DpT8k6wE.webp",import.meta.url).href,pa=""+new URL("../assets/bg-11.wYBE5Iqb.webp",import.meta.url).href,fa=""+new URL("../assets/bg-12.BVzFVYet.webp",import.meta.url).href,wa=""+new URL("../assets/bg-13.DgPho8Ft.webp",import.meta.url).href,ka=""+new URL("../assets/momotaro.fj3nA55x.webp",import.meta.url).href,ha=""+new URL("../assets/dogg.61vBLKD8.webp",import.meta.url).href,ya=""+new URL("../assets/oldwomen.ln2GG8ZQ.webp",import.meta.url).href,La=""+new URL("../assets/oldmen.DBpzstPE.webp",import.meta.url).href,ja=""+new URL("../assets/momobabe.BIdfFcwY.webp",import.meta.url).href,Ra=""+new URL("../assets/momobt.CA8rvvgQ.webp",import.meta.url).href,Ua=""+new URL("../assets/momotaro.ebbWfeul.webp",import.meta.url).href,Ca=""+new URL("../assets/momotaro.CmHSMOLf.webp",import.meta.url).href,Ea=""+new URL("../assets/monkey.BKAzoFRY.webp",import.meta.url).href,xa=""+new URL("../assets/oni.DWLc-KEX.webp",import.meta.url).href,Ia=""+new URL("../assets/peach.DUI8OICJ.webp",import.meta.url).href,Pa=""+new URL("../assets/kiji.DHDU_73U.webp",import.meta.url).href,Aa=""+new URL("../assets/momotaro.fj3nA55x.webp",import.meta.url).href,Ta=""+new URL("../assets/bg-01.CBS5RZz6.webp",import.meta.url).href,Da=""+new URL("../assets/bg-02.CMtjJ0k5.webp",import.meta.url).href,Fa=""+new URL("../assets/bg-03.mzDcu0cZ.webp",import.meta.url).href,Ba=""+new URL("../assets/bg-04.sJVqj8Sq.webp",import.meta.url).href,Na=""+new URL("../assets/bg-05.CQS1FnKl.webp",import.meta.url).href,Sa=""+new URL("../assets/bg-05_2.52RO1LNK.webp",import.meta.url).href,Ma=""+new URL("../assets/bg-06.Cahzom-G.webp",import.meta.url).href,Oa=""+new URL("../assets/bg-12.BVzFVYet.webp",import.meta.url).href,Va=""+new URL("../assets/bamboo-glowing.dwaRyHfJ.webp",import.meta.url).href,qa=""+new URL("../assets/busi.DK434y3W.webp",import.meta.url).href,za=""+new URL("../assets/emperer-sit.DH1B4Nxq.webp",import.meta.url).href,Ga=""+new URL("../assets/emperer.N8wF0lE_.webp",import.meta.url).href,Ya=""+new URL("../assets/kaguya-baby.BNoszJCh.webp",import.meta.url).href,$a=""+new URL("../assets/kaguya-emotionless-2.rnOe7mOF.webp",import.meta.url).href,Wa=""+new URL("../assets/kaguya-00.Cgo_Vstn.webp",import.meta.url).href,Za=""+new URL("../assets/kaguya-back.C9LiL6RS.webp",import.meta.url).href,Ha=""+new URL("../assets/kaguya-look.Cq1tr6wq.webp",import.meta.url).href,Ja=""+new URL("../assets/leader.C1wqYI-T.webp",import.meta.url).href,Ka=""+new URL("../assets/nobles-group.CP_Fy3Pg.webp",import.meta.url).href,Qa=""+new URL("../assets/okina-poor-sit.DPH_z079.webp",import.meta.url).href,Xa=""+new URL("../assets/okina-poor.CAtpUmmY.webp",import.meta.url).href,to=""+new URL("../assets/okina-rich-sad.DFY7xaHG.webp",import.meta.url).href,eo=""+new URL("../assets/okina-rich-wary.BZsDZEFB.webp",import.meta.url).href,ao=""+new URL("../assets/poors.B-GxcqJ6.webp",import.meta.url).href,oo=""+new URL("../assets/okina-uba-sad.CicIXVNy.webp",import.meta.url).href,so=""+new URL("../assets/okina-uba.CYaLLEy3.webp",import.meta.url).href,io=""+new URL("../assets/okina-rich-happy.Mz_wh-qs.webp",import.meta.url).href,ro=""+new URL("../assets/okina-rich.BxpjZt1i.webp",import.meta.url).href,no=""+new URL("../assets/thumbnail.CzQGrjYW.webp",import.meta.url).href,co=(i,t,n)=>{const c=i[t];return c?typeof c=="function"?c():Promise.resolve(c):new Promise((s,u)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(u.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==n?". Note that variables only represent file names one level deep.":""))))})},lo=async({params:i})=>{const{slug:t}=i,s=(await Ft(()=>import("../chunks/DS-wzHgp.js"),[],import.meta.url)).default.find(T=>T.slug===t);if(!s)throw new Error(`Production not found: ${t}`);const h=(await co(Object.assign({"../../lib/data/stories/momotaro.json":()=>Ft(()=>import("../chunks/CmeOqT5F.js"),[],import.meta.url),"../../lib/data/stories/ookinakabu.json":()=>Ft(()=>import("../chunks/rfGTYLxM.js"),[],import.meta.url),"../../lib/data/stories/taketori.json":()=>Ft(()=>import("../chunks/sNi2ISzc.js"),[],import.meta.url)}),`../../lib/data/stories/${s.storyId}.json`,6)).default,{storyId:E,productionId:w}=s,d=Object.assign({"/static/books/momotaro/images/backgrounds/bg-00.webp":ra,"/static/books/momotaro/images/backgrounds/bg-01.webp":na,"/static/books/momotaro/images/backgrounds/bg-02.webp":ca,"/static/books/momotaro/images/backgrounds/bg-03.webp":la,"/static/books/momotaro/images/backgrounds/bg-04.webp":ba,"/static/books/momotaro/images/backgrounds/bg-05.webp":va,"/static/books/momotaro/images/backgrounds/bg-06.webp":_a,"/static/books/momotaro/images/backgrounds/bg-07.webp":ua,"/static/books/momotaro/images/backgrounds/bg-08.webp":ma,"/static/books/momotaro/images/backgrounds/bg-09.webp":da,"/static/books/momotaro/images/backgrounds/bg-10.webp":ga,"/static/books/momotaro/images/backgrounds/bg-11.webp":pa,"/static/books/momotaro/images/backgrounds/bg-12.webp":fa,"/static/books/momotaro/images/backgrounds/bg-13.webp":wa,"/static/books/momotaro/images/backgrounds/momotaro.webp":ka,"/static/books/momotaro/images/origin/dog/dogg.webp":ha,"/static/books/momotaro/images/origin/grandma/oldwomen.webp":ya,"/static/books/momotaro/images/origin/grandpa/oldmen.webp":La,"/static/books/momotaro/images/origin/momotaro-baby/momobabe.webp":ja,"/static/books/momotaro/images/origin/momotaro-battle/momobt.webp":Ra,"/static/books/momotaro/images/origin/momotaro.webp":Ua,"/static/books/momotaro/images/origin/momotaro/momotaro.webp":Ca,"/static/books/momotaro/images/origin/monkey/monkey.webp":Ea,"/static/books/momotaro/images/origin/oni/oni.webp":xa,"/static/books/momotaro/images/origin/peach/peach.webp":Ia,"/static/books/momotaro/images/origin/pheasant/kiji.webp":Pa,"/static/books/momotaro/images/origin/thumbnail.webp":Aa,"/static/books/taketori/images/backgrounds/bg-01.webp":Ta,"/static/books/taketori/images/backgrounds/bg-02.webp":Da,"/static/books/taketori/images/backgrounds/bg-03.webp":Fa,"/static/books/taketori/images/backgrounds/bg-04.webp":Ba,"/static/books/taketori/images/backgrounds/bg-05.webp":Na,"/static/books/taketori/images/backgrounds/bg-05_2.webp":Sa,"/static/books/taketori/images/backgrounds/bg-06.webp":Ma,"/static/books/taketori/images/backgrounds/bg-12.webp":Oa,"/static/books/taketori/images/origin/bamboo/bamboo-glowing.webp":Va,"/static/books/taketori/images/origin/bushi/busi.webp":qa,"/static/books/taketori/images/origin/emperor/emperer-sit.webp":za,"/static/books/taketori/images/origin/emperor/emperer.webp":Ga,"/static/books/taketori/images/origin/kaguya-baby/kaguya-baby.webp":Ya,"/static/books/taketori/images/origin/kaguya-celestial/kaguya-emotionless-2.webp":$a,"/static/books/taketori/images/origin/kaguya/kaguya-00.webp":Wa,"/static/books/taketori/images/origin/kaguya/kaguya-back.webp":Za,"/static/books/taketori/images/origin/kaguya/kaguya-look.webp":Ha,"/static/books/taketori/images/origin/moon-messenger/leader.webp":Ja,"/static/books/taketori/images/origin/nobles/nobles-group.webp":Ka,"/static/books/taketori/images/origin/okina-poor/okina-poor-sit.webp":Qa,"/static/books/taketori/images/origin/okina-poor/okina-poor.webp":Xa,"/static/books/taketori/images/origin/okina-sad/okina-rich-sad.webp":to,"/static/books/taketori/images/origin/okina-sad/okina-rich-wary.webp":eo,"/static/books/taketori/images/origin/okina-uba-poor/poors.webp":ao,"/static/books/taketori/images/origin/okina-uba-sad/okina-uba-sad.webp":oo,"/static/books/taketori/images/origin/okina-uba/okina-uba.webp":so,"/static/books/taketori/images/origin/okina/okina-rich-happy.webp":io,"/static/books/taketori/images/origin/okina/okina-rich.webp":ro,"/static/books/taketori/images/origin/thumbnail.webp":no}),f=h.pages.map(T=>{const g=T.characters.map(y=>{const B=y.imagesFolder,b=`/static/books/${E}/images/${w}/${B}/`,v=Object.keys(d).filter(m=>m.startsWith(b)).map(m=>m.replace("/static","")).sort();return{...y,imageVariants:v}});return{...T,characters:g}});return{book:{id:s.id,slug:s.slug,storyId:s.storyId,productionId:s.productionId,title:h.title,thumbnail:s.thumbnail,origin:h.origin,year:s.year,className:s.className,kindergarten:s.kindergarten||"",createdDate:s.createdDate||"",pageCount:h.pageCount,pages:f,characters:h.characters,credits:h.credits,productionCredits:s.credits}}};function bo(){return Te.map(i=>({slug:i.slug}))}const Xo=Object.freeze(Object.defineProperty({__proto__:null,entries:bo,load:lo},Symbol.toStringTag,{value:"Module"})),vo=i=>i;function _o(i){const t=i-1;return t*t*t+1}function ge(i){const t=typeof i=="string"&&i.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return t?[parseFloat(t[1]),t[2]||"px"]:[i,"px"]}function uo(i,{delay:t=0,duration:n=400,easing:c=vo}={}){const s=+getComputedStyle(i).opacity;return{delay:t,duration:n,easing:c,css:u=>`opacity: ${u*s}`}}function pe(i,{delay:t=0,duration:n=400,easing:c=_o,x:s=0,y:u=0,opacity:h=0}={}){const E=getComputedStyle(i),w=+E.opacity,d=E.transform==="none"?"":E.transform,f=w*(1-h),[T,g]=ge(s),[y,B]=ge(u);return{delay:t,duration:n,easing:c,css:(b,v)=>`
			transform: ${d} translate(${(1-b)*T}${g}, ${(1-b)*y}${B});
			opacity: ${w-f*v}`}}function fe(i){return--i*i*i*i*i+1}var mo=R('<div class="background-image svelte-17jpt1s"></div>'),go=R("<img/>"),po=R('<div class="book-page svelte-17jpt1s"><div class="background-layer svelte-17jpt1s"><!></div> <!></div>');function fo(i,t){St(t,!0);function n(E){return(t.subtitle.animations?.[E]||"none").split(" ").filter(d=>d!=="none").map(d=>`animate-${d}`).join(" ")}var c=po(),s=o(c),u=o(s);me(u,()=>t.page.background,E=>{var w=mo();D(d=>Zt(w,`background-image: url(${d??""})`),[()=>rt(t.page.background)]),Wt(1,w,()=>pe,()=>({x:t.direction==="right"?100:-100,duration:800,easing:fe})),Wt(2,w,()=>pe,()=>({x:t.direction==="right"?-100:100,duration:800,easing:fe})),k(E,w)}),a(s);var h=r(s,2);jt(h,17,()=>t.page.characters,Rt,(E,w,d)=>{var f=Ht(),T=_t(f);{var g=y=>{var B=Ht(),b=_t(B);me(b,()=>t.selectedImages[d],v=>{var m=go();D((l,_)=>{V(m,"src",l),V(m,"alt",`キャラクター ${e(w).id??""}`),z(m,1,`character ${_??""}`,"svelte-17jpt1s"),Zt(m,`
          left: ${e(w).position.x??""}%; 
          top: ${e(w).position.y??""}%; 
          --scale: ${e(w).scale??1??""};
					--flip: ${e(w).flip??1??""};
        `)},[()=>rt(t.selectedImages[d]),()=>n(e(w).id)]),Wt(3,m,()=>uo),k(v,m)}),k(y,B)};M(T,y=>{t.selectedImages[d]&&y(g)})}k(E,f)}),a(c),k(i,c),Mt()}var wo=R('<div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">参加人数：</span> <span class="value svelte-1hu0b6n"> </span></div>'),ko=R('<div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">イラスト：</span> <span class="value svelte-1hu0b6n"> </span></div> <!>',1),ho=R('<p class="notes svelte-1hu0b6n"> </p>'),yo=R('<section class="credits-section production svelte-1hu0b6n"><h3 class="svelte-1hu0b6n">制作</h3> <div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">制作園：</span> <span class="value svelte-1hu0b6n"> </span></div> <div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">クラス：</span> <span class="value svelte-1hu0b6n"> </span></div> <!> <!></section>'),Lo=R('<div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">脚色：</span> <span class="value svelte-1hu0b6n"> </span></div>'),jo=R('<section class="credits-section svelte-1hu0b6n"><h3 class="svelte-1hu0b6n">原作・脚本</h3> <div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">原作：</span> <span class="value svelte-1hu0b6n"> </span></div> <!></section>'),Ro=R('<div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">背景：</span> <span class="value svelte-1hu0b6n"> </span></div>'),Uo=R('<div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">キャラクター：</span> <span class="value svelte-1hu0b6n"> </span></div>'),Co=R('<section class="credits-section svelte-1hu0b6n"><h3 class="svelte-1hu0b6n">ビジュアル</h3> <!> <!></section>'),Eo=R('<div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">ナレーション：</span> <span class="value svelte-1hu0b6n"> </span></div>'),xo=R("<div> </div>"),Io=R('<div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">声：</span> <span class="value svelte-1hu0b6n"></span></div>'),Po=R('<div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">BGM：</span> <span class="value svelte-1hu0b6n"> </span></div>'),Ao=R('<section class="credits-section svelte-1hu0b6n"><h3 class="svelte-1hu0b6n">音声</h3> <!> <!> <!></section>'),To=R('<button class="back-button svelte-1hu0b6n"><iconify-icon></iconify-icon> 絵本に戻る</button>',2),Do=R('<div class="credits-page svelte-1hu0b6n"><div class="credits-header svelte-1hu0b6n"><p class="credits-subtitle svelte-1hu0b6n">さくしゃ、そざいなど</p></div> <div class="credits-content svelte-1hu0b6n"><!> <!> <!> <!></div> <!></div>');function Fo(i,t){St(t,!0);const n=t.book.credits?.story,c=t.book.credits?.visuals,s=t.book.credits?.audio,u=t.book.productionCredits;var h=Do(),E=r(o(h),2),w=o(E);{var d=l=>{var _=yo(),U=r(o(_),2),F=r(o(U),2),C=o(F,!0);a(F),a(U);var S=r(U,2),p=r(o(S),2),L=o(p);a(p),a(S);var j=r(S,2);{var x=Z=>{var q=ko(),Y=_t(q),ut=r(o(Y),2),Ut=o(ut,!0);a(ut),a(Y);var Ot=r(Y,2);{var mt=nt=>{var ct=wo(),Ct=r(o(ct),2),Et=o(Ct);a(Ct),a(ct),D(()=>N(Et,`${u.illustrations.participants??""}名`)),k(nt,ct)};M(Ot,nt=>{u.illustrations.participants&&nt(mt)})}D(()=>N(Ut,u.illustrations.method)),k(Z,q)};M(j,Z=>{u.illustrations&&Z(x)})}var O=r(j,2);{var J=Z=>{var q=ho(),Y=o(q,!0);a(q),D(()=>N(Y,u.notes)),k(Z,q)};M(O,Z=>{u.notes&&Z(J)})}a(_),D(()=>{N(C,u.production.kindergarten),N(L,`${u.production.year??""}年 ${u.production.class??""}`)}),k(l,_)};M(w,l=>{u&&l(d)})}var f=r(w,2);{var T=l=>{var _=jo(),U=r(o(_),2),F=r(o(U),2),C=o(F,!0);a(F),a(U);var S=r(U,2);{var p=L=>{var j=Lo(),x=r(o(j),2),O=o(x,!0);a(x),a(j),D(()=>N(O,n.adaptation)),k(L,j)};M(S,L=>{n.adaptation&&L(p)})}a(_),D(()=>N(C,n.original)),k(l,_)};M(f,l=>{n&&l(T)})}var g=r(f,2);{var y=l=>{var _=Co(),U=r(o(_),2);{var F=p=>{var L=Ro(),j=r(o(L),2),x=o(j,!0);a(j),a(L),D(()=>N(x,c.backgrounds)),k(p,L)};M(U,p=>{c.backgrounds&&p(F)})}var C=r(U,2);{var S=p=>{var L=Uo(),j=r(o(L),2),x=o(j,!0);a(j),a(L),D(()=>N(x,c.characterDesign)),k(p,L)};M(C,p=>{c.characterDesign&&!u&&p(S)})}a(_),k(l,_)};M(g,l=>{c&&l(y)})}var B=r(g,2);{var b=l=>{var _=Ao(),U=r(o(_),2);{var F=j=>{var x=Eo(),O=r(o(x),2),J=o(O,!0);a(O),a(x),D(()=>N(J,s.narration)),k(j,x)};M(U,j=>{s.narration&&j(F)})}var C=r(U,2);{var S=j=>{var x=Io(),O=r(o(x),2);jt(O,21,()=>s.voice,Rt,(J,Z)=>{var q=xo(),Y=o(q,!0);a(q),D(()=>N(Y,e(Z))),k(J,q)}),a(O),a(x),k(j,x)};M(C,j=>{s.voice&&j(S)})}var p=r(C,2);{var L=j=>{var x=Po(),O=r(o(x),2),J=o(O,!0);a(O),a(x),D(()=>N(J,s.bgm)),k(j,x)};M(p,j=>{s.bgm&&j(L)})}a(_),k(l,_)};M(B,l=>{s&&l(b)})}a(E);var v=r(E,2);{var m=l=>{var _=To();_.__click=function(...F){t.onClose?.apply(this,F)};var U=o(_);G(U,"icon","mdi:arrow-left"),Lt(),a(_),k(l,_)};M(v,l=>{t.onClose&&l(m)})}a(h),k(i,h),Mt()}Kt(["click"]);var Bo=R('<button class="image-card svelte-sdywjb"><img class="svelte-sdywjb"/> <div class="image-number svelte-sdywjb"></div></button>'),No=R('<section class="character-section svelte-sdywjb"><h3 class="character-name svelte-sdywjb"> </h3> <div class="image-grid svelte-sdywjb"></div></section>'),So=R('<div class="modal-container svelte-sdywjb"><button class="image-modal-backdrop svelte-sdywjb" aria-label="モーダルを閉じる"></button> <div class="modal-content svelte-sdywjb"><button class="close-button svelte-sdywjb" aria-label="閉じる"><iconify-icon></iconify-icon></button> <img alt="拡大画像" class="modal-image svelte-sdywjb"/> <p class="modal-caption svelte-sdywjb"> </p></div></div>',2),Mo=R('<button class="back-button svelte-sdywjb"><iconify-icon></iconify-icon> 絵本に戻る</button>',2),Oo=R('<div class="gallery-page svelte-sdywjb"><div class="gallery-header svelte-sdywjb"><p class="gallery-subtitle svelte-sdywjb">みんなが かいたえを みてみよう</p></div> <div class="gallery-content svelte-sdywjb"></div> <!> <!></div>');function Vo(i,t){St(t,!0);let n=W(null),c=W(null),s=Nt(()=>{const b=new Map;return t.book.pages.forEach(v=>{v.characters.forEach(m=>{b.has(m.id)||b.set(m.id,new Set),m.imageVariants&&m.imageVariants.forEach(l=>{b.get(m.id).add(l)})})}),Array.from(b.entries()).map(([v,m])=>({id:v,name:u(v),description:h(v),images:Array.from(m).sort()}))});function u(b){return t.book.characters?.[b]?.name||b}function h(b){return t.book.characters?.[b]?.description}function E(b,v){P(n,b,!0),P(c,v,!0)}function w(){P(n,null),P(c,null)}var d=Oo(),f=r(o(d),2);jt(f,21,()=>e(s),Rt,(b,v)=>{var m=No(),l=o(m),_=o(l,!0);a(l);var U=r(l,2);jt(U,21,()=>e(v).images,Rt,(F,C,S)=>{var p=Bo();p.__click=()=>E(e(C),e(v).id);var L=o(p),j=r(L,2);j.textContent=S+1,a(p),D(x=>{V(p,"aria-label",`${e(v).name??""}の絵 ${S+1}`),V(L,"src",x),V(L,"alt",`${e(v).name??""}の絵`)},[()=>rt(e(C))]),k(F,p)}),a(U),a(m),D(()=>N(_,e(v).name)),k(b,m)}),a(f);var T=r(f,2);{var g=b=>{var v=So(),m=o(v);m.__click=w;var l=r(m,2),_=o(l);_.__click=w;var U=o(_);G(U,"icon","mdi:close"),a(_);var F=r(_,2),C=r(F,2),S=o(C);a(C),a(l),a(v),D((p,L)=>{V(F,"src",p),N(S,`${L??""}の絵`)},[()=>rt(e(n)),()=>u(e(c)||"")]),k(b,v)};M(T,b=>{e(n)&&b(g)})}var y=r(T,2);{var B=b=>{var v=Mo();v.__click=function(...l){t.onClose?.apply(this,l)};var m=o(v);G(m,"icon","mdi:arrow-left"),Lt(),a(v),k(b,v)};M(y,b=>{t.onClose&&b(B)})}a(d),k(i,d),Mt()}Kt(["click"]);var qo=R('<meta name="description"/> <meta property="og:title"/> <meta property="og:image"/> <meta property="og:url"/>',1),zo=R("<a> </a>"),Go=R('<div class="book-content svelte-jot9ci"><a class="page-area svelte-jot9ci"><!></a> <div class="subtitle-area svelte-jot9ci"><div class="subtitle-container pc-view svelte-jot9ci"></div> <div class="subtitle-container mobile-view svelte-jot9ci"><a class="subtitle-text active svelte-jot9ci"> </a></div></div></div> <audio></audio> <div class="controls svelte-jot9ci"><div class="subtitle-controls svelte-jot9ci"><button aria-label="前場面" class="svelte-jot9ci"><iconify-icon></iconify-icon></button> <div class="flex gap-2 svelte-jot9ci"><button aria-label="音声有無"><iconify-icon></iconify-icon></button> <button aria-label="オート再生"><iconify-icon></iconify-icon></button> <button class="svelte-jot9ci"><iconify-icon></iconify-icon></button></div> <button aria-label="次場面" class="svelte-jot9ci"><iconify-icon></iconify-icon></button></div> <div class="page-controls svelte-jot9ci"><button aria-label="前ページ" class="svelte-jot9ci"><iconify-icon></iconify-icon></button> <span class="page-indicator svelte-jot9ci"> </span> <div class="progress svelte-jot9ci"> </div> <button aria-label="次ページ" class="svelte-jot9ci"><iconify-icon></iconify-icon></button></div></div>',3),Yo=R('<div class="container"><header class="header svelte-jot9ci"><h1 class="title svelte-jot9ci"> </h1></header> <nav aria-label="パンくずリスト"><ol class="breadcrumb svelte-jot9ci"><li><a href="./">絵本一覧</a></li> <li> </li></ol></nav> <main class="book-viewer svelte-jot9ci"><div class="tab-navigation svelte-jot9ci"><button><iconify-icon></iconify-icon> えほん</button> <button><iconify-icon></iconify-icon> ギャラリー</button> <button><iconify-icon></iconify-icon> さくしゃ</button></div> <!></main></div>',2);function ts(i,t){St(t,!0);const n=t.data.book;let c=W(0),s=W(0),u=W(!0),h=W(0);async function E(){const A=[],I=[];n.pages.forEach(H=>{H.background&&A.push(H.background),H.characters.forEach($=>{$.imageVariants?.forEach(Q=>{A.push(Q)})}),H.subtitles.forEach($=>{$.audio&&I.push($.audio)})});const et=[...new Set(A)],at=[...new Set(I)],ot=et.length,K=et.length+at.length;let X=0;const pt=et.map(H=>new Promise(($,Q)=>{const lt=new Image;lt.onload=()=>{X++,P(h,Math.round(X/ot*100),!0),$()},lt.onerror=()=>{console.warn(`Failed to load image: ${H}`),X++,P(h,Math.round(X/ot*100),!0),$()},lt.src=rt(H)})),st=at.map(H=>new Promise($=>{const Q=new Audio;Q.oncanplaythrough=Q.onerror=()=>{X++,P(h,Math.round(X/K*100),!0),$()},Q.src=rt(H)}));await Promise.all([...pt,...st])}ue(async()=>{await E(),setTimeout(()=>{P(u,!1)},300)});let w=W("right"),d=W(!1),f=W(!0),T=W(!0),g=W(null),y=W("book");const B=De();function b(){p(),P(y,"gallery")}function v(){P(y,"book")}function m(){p(),P(y,"credits")}function l(A){return A.characters.map(I=>!I.imageVariants||I.imageVariants.length===0?(console.warn(`No images for character ${I.id}`),null):I.imageVariants[Math.floor(Math.random()*I.imageVariants.length)])}let _=Nt(()=>n.pages[e(c)]),U=Nt(()=>e(_).subtitles[e(s)]),F=Nt(()=>l(e(_)));async function C(){if(!(!e(g)||!e(f)))try{e(g).pause(),e(g).readyState<2&&await new Promise(A=>{const I=()=>{e(g)?.removeEventListener("canplay",I),A()};e(g)?.addEventListener("canplay",I),setTimeout(()=>{e(g)?.removeEventListener("canplay",I),A()},5e3)}),await e(g).play(),P(d,!0)}catch(A){console.warn("音声再生エラー:",A),P(d,!1)}}function S(){setTimeout(()=>{P(d,!1)},100),e(T)&&(e(s)<e(_).subtitles.length-1?(vt(s),setTimeout(()=>{e(f)&&C()},100)):e(c)<n.pages.length-1&&(vt(c),P(s,0),setTimeout(()=>{e(f)&&C()},100)))}function p(){e(g)&&(e(g).pause(),e(g).currentTime=0,P(d,!1))}function L(){e(d)?p():C()}function j(){p(),e(c)<n.pages.length-1&&(P(w,"right"),vt(c),P(s,0),C(),setTimeout(()=>{e(f)&&C()},100))}function x(){p(),e(c)>0&&(P(w,"left"),vt(c,-1),P(s,0))}function O(){p(),e(s)<e(_).subtitles.length-1&&(vt(s),setTimeout(()=>{e(f)&&C()},100))}function J(){p(),e(s)>0&&vt(s,-1)}function Z(A){P(s,A,!0),p(),C()}ue(()=>{const A=I=>{I.key===" "&&L(),I.key==="ArrowRight"&&O(),I.key==="ArrowLeft"&&J(),I.key==="ArrowDown"&&j(),I.key==="ArrowUp"&&x(),I.key==="Escape"&&v()};return window.addEventListener("keydown",A),()=>window.removeEventListener("keydown",A)}),Fe(()=>{e(g)&&(e(g).pause(),P(g,null))});var q=Yo();ta(A=>{var I=qo(),et=_t(I),at=r(et,2),ot=r(at,2),K=r(ot,2);D(()=>{Qe.title=`${n.title??""} | えほんアワーズ`,V(et,"content",`${n.title??""}の絵本。${n.kindergarten??""} ${n.className??""}の作品。`),V(at,"content",`${n.title??""} | えほんアワーズ`),V(ot,"content",n.thumbnail),V(K,"content",`https://ehon-hours.com/books/${n.slug??""}`)}),k(A,I)});var Y=o(q);let ut;var Ut=o(Y),Ot=o(Ut);a(Ut),a(Y);var mt=r(Y,2),nt=o(mt),ct=r(o(nt),2),Ct=o(ct,!0);a(ct),a(nt),a(mt);var Et=r(mt,2),Vt=o(Et),dt=o(Vt);let Qt;dt.__click=v;var he=o(dt);G(he,"icon","mdi:book-open-page-variant"),Lt(),a(dt);var gt=r(dt,2);let Xt;gt.__click=b;var ye=o(gt);G(ye,"icon","mdi:image-multiple"),Lt(),a(gt);var xt=r(gt,2);let te;xt.__click=m;var Le=o(xt);G(Le,"icon","mdi:information-outline"),Lt(),a(xt),a(Vt);var je=r(Vt,2);{var Re=A=>{Fo(A,{get book(){return n},onClose:v})},Ue=A=>{var I=Ht(),et=_t(I);{var at=K=>{Vo(K,{get book(){return n},onClose:v})},ot=K=>{var X=Go(),pt=_t(X),st=o(pt);V(st,"href",null),st.__click=L;var H=o(st);fo(H,{get page(){return e(_)},get subtitle(){return e(U)},get selectedImages(){return e(F)},get direction(){return e(w)}}),a(st);var $=r(st,2),Q=o($);jt(Q,21,()=>e(_).subtitles,Rt,(it,Ie,$t)=>{var bt=zo();V(bt,"href",null),bt.__click=()=>Z($t);let _e;var Pe=o(bt,!0);a(bt),D(()=>{_e=z(bt,1,"subtitle-text svelte-jot9ci",null,_e,{active:$t===e(s),past:$t<e(s)}),N(Pe,e(Ie).text)}),k(it,bt)}),a(Q);var lt=r(Q,2),It=o(lt);V(It,"href",null),It.__click=L;var Ce=o(It,!0);a(It),a(lt),a($),a(pt);var Pt=r(pt,2);Ae(Pt,it=>P(g,it),()=>e(g));var ee=r(Pt,2),qt=o(ee),ft=o(qt);ft.__click=J;var ae=o(ft);G(ae,"icon","mdi:chevron-left"),z(ae,1,"icon svelte-jot9ci"),a(ft);var zt=r(ft,2),wt=o(zt);wt.__click=()=>P(f,!e(f));let oe;var se=o(wt);D(()=>G(se,"icon",e(f)?"mdi:volume-high":"mdi:volume-off")),z(se,1,"icon svelte-jot9ci"),a(wt);var kt=r(wt,2);kt.__click=()=>P(T,!e(T));let ie;var re=o(kt);G(re,"icon","material-symbols:autoplay"),z(re,1,"icon svelte-jot9ci"),a(kt);var At=r(kt,2);At.__click=function(...it){(e(d)?p:C)?.apply(this,it)};var ne=o(At);D(()=>G(ne,"icon",e(d)?"mdi:pause":"mdi:play")),z(ne,1,"icon svelte-jot9ci"),a(At),a(zt);var Tt=r(zt,2);Tt.__click=O;var ce=o(Tt);G(ce,"icon","mdi:chevron-right"),z(ce,1,"icon svelte-jot9ci"),a(Tt),a(qt);var le=r(qt,2),ht=o(le);ht.__click=x;var be=o(ht);G(be,"icon","mdi:chevron-left"),z(be,1,"icon svelte-jot9ci"),a(ht);var Gt=r(ht,2),Ee=o(Gt);a(Gt);var Yt=r(Gt,2),xe=o(Yt);a(Yt);var Dt=r(Yt,2);Dt.__click=j;var ve=o(Dt);G(ve,"icon","mdi:chevron-right"),z(ve,1,"icon svelte-jot9ci"),a(Dt),a(le),a(ee),D(it=>{N(Ce,e(U).text),V(Pt,"src",it),ft.disabled=e(s)===0,oe=z(wt,1,"svelte-jot9ci",null,oe,{"bg-off":!e(f)}),ie=z(kt,1,"svelte-jot9ci",null,ie,{"bg-off":!e(T)}),V(At,"aria-label",e(d)?"一時停止":"再生"),Tt.disabled=e(s)===e(_).subtitles.length-1,ht.disabled=e(c)===0,N(Ee,`ページ：${e(c)+1} / ${n.pages.length??""}`),N(xe,`ばめん：${e(s)+1} / ${e(_).subtitles.length??""}`),Dt.disabled=e(c)===n.pages.length-1},[()=>rt(e(U).audio)]),ea("ended",Pt,S),k(K,X)};M(et,K=>{e(y)==="gallery"?K(at):K(ot,!1)},!0)}k(A,I)};M(je,A=>{e(y)==="credits"?A(Re):A(Ue,!1)})}a(Et),a(q),D(()=>{ut=Zt(Y,"",ut,{"--bg-color":B?.kindergartenColor||"#f8f9fa"}),N(Ot,`${n.title??""} - ${n.className??""}`),N(Ct,n.title),Qt=z(dt,1,"tab-button svelte-jot9ci",null,Qt,{active:e(y)==="book"}),Xt=z(gt,1,"tab-button svelte-jot9ci",null,Xt,{active:e(y)==="gallery"}),te=z(xt,1,"tab-button svelte-jot9ci",null,te,{active:e(y)==="credits"})}),k(i,q),Mt()}Kt(["click"]);export{ts as component,Xo as universal};
