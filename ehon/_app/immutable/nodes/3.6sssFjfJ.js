import{_ as Bt,b as Te}from"../chunks/CjPccBOC.js";import{b as Ae,e as Rt,i as Lt,r as rt,c as Yt,s as O,f as W,d as z,g as De}from"../chunks/Bq8JwGOw.js";import"../chunks/DsnmJJEf.js";import{o as be,a as Be}from"../chunks/BO8TDW0E.js";import{z as Fe,A as Ne,ba as Se,y as Me,D as Ve,a9 as Oe,E as qe,bb as We,bc as ze,T as $e,h as Ge,bd as Xe,be as Ye,bf as He,as as he,bg as Ze,V as Je,n as yt,X as St,Y as L,a1 as o,a2 as a,a3 as r,a4 as Ht,Z as ut,$ as w,a0 as Mt,_ as D,g as e,am as jt,aR as Nt,aQ as X,s as P,aW as Qe,bh as mt}from"../chunks/Diw6UIRm.js";import{b as Ke,d as Jt,s as N,a as ta,e as ea}from"../chunks/DuK_nuCY.js";import{i as M}from"../chunks/BC6CTdml.js";function _e(i,t,n){Fe&&Ne();var c=new Ve(i),s=!Se();Me(()=>{var b=t();s&&b!==null&&typeof b=="object"&&(b={}),c.ensure(b,n)})}const aa=()=>performance.now(),tt={tick:i=>requestAnimationFrame(i),now:()=>aa(),tasks:new Set};function we(){const i=tt.now();tt.tasks.forEach(t=>{t.c(i)||(tt.tasks.delete(t),t.f())}),tt.tasks.size!==0&&tt.tick(we)}function oa(i){let t;return tt.tasks.size===0&&tt.tick(we),{promise:new Promise(n=>{tt.tasks.add(t={c:i,f:n})}),abort(){tt.tasks.delete(t)}}}function Ft(i,t){he(()=>{i.dispatchEvent(new CustomEvent(t))})}function sa(i){if(i==="float")return"cssFloat";if(i==="offset")return"cssOffset";if(i.startsWith("--"))return i;const t=i.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(n=>n[0].toUpperCase()+n.slice(1)).join("")}function de(i){const t={},n=i.split(";");for(const c of n){const[s,b]=c.split(":");if(!s||b===void 0)break;const k=sa(s.trim());t[k]=b.trim()}return t}const ia=i=>i;function Xt(i,t,n,c){var s=(i&Ye)!==0,b=(i&He)!==0,k=s&&b,E=(i&Xe)!==0,h=k?"both":s?"in":"out",d,f=t.inert,A=t.style.overflow,p,y;function F(){return he(()=>d??=n()(t,c?.()??{},{direction:h}))}var v={is_global:E,in(){if(t.inert=f,!s){y?.abort(),y?.reset?.();return}b||p?.abort(),Ft(t,"introstart"),p=Zt(t,F(),y,1,()=>{Ft(t,"introend"),p?.abort(),p=d=void 0,t.style.overflow=A})},out(u){if(!b){u?.(),d=void 0;return}t.inert=!0,Ft(t,"outrostart"),y=Zt(t,F(),p,0,()=>{Ft(t,"outroend"),u?.()})},stop:()=>{p?.abort(),y?.abort()}},m=Oe;if((m.transitions??=[]).push(v),s&&Ke){var _=E;if(!_){for(var l=m.parent;l&&(l.f&qe)!==0;)for(;(l=l.parent)&&(l.f&We)===0;);_=!l||(l.f&ze)!==0}_&&$e(()=>{Ge(()=>v.in())})}}function Zt(i,t,n,c,s){var b=c===1;if(Ze(t)){var k,E=!1;return Je(()=>{if(!E){var m=t({direction:b?"in":"out"});k=Zt(i,m,n,c,s)}}),{abort:()=>{E=!0,k?.abort()},deactivate:()=>k.deactivate(),reset:()=>k.reset(),t:()=>k.t()}}if(n?.deactivate(),!t?.duration)return s(),{abort:yt,deactivate:yt,reset:yt,t:()=>c};const{delay:h=0,css:d,tick:f,easing:A=ia}=t;var p=[];if(b&&n===void 0&&(f&&f(0,1),d)){var y=de(d(0,1));p.push(y,y)}var F=()=>1-c,v=i.animate(p,{duration:h,fill:"forwards"});return v.onfinish=()=>{v.cancel();var m=n?.t()??1-c;n?.abort();var _=c-m,l=t.duration*Math.abs(_),u=[];if(l>0){var U=!1;if(d)for(var B=Math.ceil(l/16.666666666666668),C=0;C<=B;C+=1){var S=m+_*A(C/B),g=de(d(S,1-S));u.push(g),U||=g.overflow==="hidden"}U&&(i.style.overflow="hidden"),F=()=>{var j=v.currentTime;return m+_*A(j/l)},f&&oa(()=>{if(v.playState!=="running")return!1;var j=F();return f(j,1-j),!0})}v=i.animate(u,{duration:l,fill:"forwards"}),v.onfinish=()=>{F=()=>c,f?.(c,1-c),s()}},{abort:()=>{v&&(v.cancel(),v.effect=null,v.onfinish=yt)},deactivate:()=>{s=yt},reset:()=>{c===0&&f?.(1,0)},t:()=>F()}}const ra=""+new URL("../assets/bg-00.BGAGFz8T.webp",import.meta.url).href,na=""+new URL("../assets/bg-01.BrBSel-Z.webp",import.meta.url).href,ca=""+new URL("../assets/bg-02.ZI4Quqob.webp",import.meta.url).href,la=""+new URL("../assets/bg-03.8lNxmXEy.webp",import.meta.url).href,va=""+new URL("../assets/bg-04.B4tJgvPy.webp",import.meta.url).href,ma=""+new URL("../assets/bg-05.XCqrNzDV.webp",import.meta.url).href,ua=""+new URL("../assets/bg-06.B2CJF--9.webp",import.meta.url).href,ba=""+new URL("../assets/bg-07.DnFXE2UN.webp",import.meta.url).href,_a=""+new URL("../assets/bg-08.C5H5IlCl.webp",import.meta.url).href,da=""+new URL("../assets/bg-09.DE4eBF9u.webp",import.meta.url).href,pa=""+new URL("../assets/bg-10.DpT8k6wE.webp",import.meta.url).href,ga=""+new URL("../assets/bg-11.wYBE5Iqb.webp",import.meta.url).href,fa=""+new URL("../assets/bg-12.BVzFVYet.webp",import.meta.url).href,ha=""+new URL("../assets/bg-13.DgPho8Ft.webp",import.meta.url).href,wa=""+new URL("../assets/momotaro.fj3nA55x.webp",import.meta.url).href,ka=""+new URL("../assets/inu01.Ceewy7ki.webp",import.meta.url).href,ya=""+new URL("../assets/inu02.CdTxFTXZ.webp",import.meta.url).href,ja=""+new URL("../assets/inu03.Cqwj3F_q.webp",import.meta.url).href,Ra=""+new URL("../assets/kerberosu.3pYGG8iW.webp",import.meta.url).href,La=""+new URL("../assets/obaasan.DIHFz1oC.webp",import.meta.url).href,Ua=""+new URL("../assets/obaasan02.CPy78usm.webp",import.meta.url).href,Ca=""+new URL("../assets/ojiisan02.CkEu6UoA.webp",import.meta.url).href,Ea=""+new URL("../assets/ojisan.BSEtEY4W.webp",import.meta.url).href,xa=""+new URL("../assets/baby01.H8AUnBKR.webp",import.meta.url).href,Ia=""+new URL("../assets/baby02.DYmXN7av.webp",import.meta.url).href,Pa=""+new URL("../assets/momo (1).b3f8J2qq.webp",import.meta.url).href,Ta=""+new URL("../assets/momo02.DgjBBfH8.webp",import.meta.url).href,Aa=""+new URL("../assets/momot.BvuclWxB.webp",import.meta.url).href,Da=""+new URL("../assets/momotaro.fj3nA55x.webp",import.meta.url).href,Ba=""+new URL("../assets/momo (1).b3f8J2qq.webp",import.meta.url).href,Fa=""+new URL("../assets/momo02.DgjBBfH8.webp",import.meta.url).href,Na=""+new URL("../assets/momot.BvuclWxB.webp",import.meta.url).href,Sa=""+new URL("../assets/kingkong.iwHlP6WD.webp",import.meta.url).href,Ma=""+new URL("../assets/kitunezaru.TWC84dVc.webp",import.meta.url).href,Va=""+new URL("../assets/saru01.7s4WaRRr.webp",import.meta.url).href,Oa=""+new URL("../assets/saru02.DQZ57JQO.webp",import.meta.url).href,qa=""+new URL("../assets/gobrin.DYNIYTPr.webp",import.meta.url).href,Wa=""+new URL("../assets/oni.B8mBj_-f.webp",import.meta.url).href,za=""+new URL("../assets/apple.CSyiXNis.webp",import.meta.url).href,$a=""+new URL("../assets/momo.hCBvV8at.webp",import.meta.url).href,Ga=""+new URL("../assets/suica.BhY1dZr4.webp",import.meta.url).href,Xa=""+new URL("../assets/kiji01.DjXgart6.webp",import.meta.url).href,Ya=""+new URL("../assets/tori02.CjQ87WEy.webp",import.meta.url).href,Ha=""+new URL("../assets/thumbnail.CFF8uD8X.webp",import.meta.url).href,Za=(i,t,n)=>{const c=i[t];return c?typeof c=="function"?c():Promise.resolve(c):new Promise((s,b)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(b.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==n?". Note that variables only represent file names one level deep.":""))))})},Ja=async({params:i})=>{const{slug:t}=i,s=(await Bt(()=>import("../chunks/CR1gARWJ.js"),[],import.meta.url)).default.find(A=>A.slug===t);if(!s)throw new Error(`Production not found: ${t}`);const k=(await Za(Object.assign({"../../lib/data/stories/momotaro.json":()=>Bt(()=>import("../chunks/o0Kt0jZC.js"),[],import.meta.url),"../../lib/data/stories/ookinakabu.json":()=>Bt(()=>import("../chunks/rfGTYLxM.js"),[],import.meta.url),"../../lib/data/stories/taketori.json":()=>Bt(()=>import("../chunks/sNi2ISzc.js"),[],import.meta.url)}),`../../lib/data/stories/${s.storyId}.json`,6)).default,{storyId:E,productionId:h}=s,d=Object.assign({"/static/books/momotaro/images/backgrounds/bg-00.webp":ra,"/static/books/momotaro/images/backgrounds/bg-01.webp":na,"/static/books/momotaro/images/backgrounds/bg-02.webp":ca,"/static/books/momotaro/images/backgrounds/bg-03.webp":la,"/static/books/momotaro/images/backgrounds/bg-04.webp":va,"/static/books/momotaro/images/backgrounds/bg-05.webp":ma,"/static/books/momotaro/images/backgrounds/bg-06.webp":ua,"/static/books/momotaro/images/backgrounds/bg-07.webp":ba,"/static/books/momotaro/images/backgrounds/bg-08.webp":_a,"/static/books/momotaro/images/backgrounds/bg-09.webp":da,"/static/books/momotaro/images/backgrounds/bg-10.webp":pa,"/static/books/momotaro/images/backgrounds/bg-11.webp":ga,"/static/books/momotaro/images/backgrounds/bg-12.webp":fa,"/static/books/momotaro/images/backgrounds/bg-13.webp":ha,"/static/books/momotaro/images/backgrounds/momotaro.webp":wa,"/static/books/momotaro/images/himawari-2023/dog/inu01.webp":ka,"/static/books/momotaro/images/himawari-2023/dog/inu02.webp":ya,"/static/books/momotaro/images/himawari-2023/dog/inu03.webp":ja,"/static/books/momotaro/images/himawari-2023/dog/kerberosu.webp":Ra,"/static/books/momotaro/images/himawari-2023/grandma/obaasan.webp":La,"/static/books/momotaro/images/himawari-2023/grandma/obaasan02.webp":Ua,"/static/books/momotaro/images/himawari-2023/grandpa/ojiisan02.webp":Ca,"/static/books/momotaro/images/himawari-2023/grandpa/ojisan.webp":Ea,"/static/books/momotaro/images/himawari-2023/momotaro-baby/baby01.webp":xa,"/static/books/momotaro/images/himawari-2023/momotaro-baby/baby02.webp":Ia,"/static/books/momotaro/images/himawari-2023/momotaro-battle/momo (1).webp":Pa,"/static/books/momotaro/images/himawari-2023/momotaro-battle/momo02.webp":Ta,"/static/books/momotaro/images/himawari-2023/momotaro-battle/momot.webp":Aa,"/static/books/momotaro/images/himawari-2023/momotaro.webp":Da,"/static/books/momotaro/images/himawari-2023/momotaro/momo (1).webp":Ba,"/static/books/momotaro/images/himawari-2023/momotaro/momo02.webp":Fa,"/static/books/momotaro/images/himawari-2023/momotaro/momot.webp":Na,"/static/books/momotaro/images/himawari-2023/monkey/kingkong.webp":Sa,"/static/books/momotaro/images/himawari-2023/monkey/kitunezaru.webp":Ma,"/static/books/momotaro/images/himawari-2023/monkey/saru01.webp":Va,"/static/books/momotaro/images/himawari-2023/monkey/saru02.webp":Oa,"/static/books/momotaro/images/himawari-2023/oni/gobrin.webp":qa,"/static/books/momotaro/images/himawari-2023/oni/oni.webp":Wa,"/static/books/momotaro/images/himawari-2023/peach/apple.webp":za,"/static/books/momotaro/images/himawari-2023/peach/momo.webp":$a,"/static/books/momotaro/images/himawari-2023/peach/suica.webp":Ga,"/static/books/momotaro/images/himawari-2023/pheasant/kiji01.webp":Xa,"/static/books/momotaro/images/himawari-2023/pheasant/tori02.webp":Ya,"/static/books/momotaro/images/himawari-2023/thumbnail.webp":Ha}),f=k.pages.map(A=>{const p=A.characters.map(y=>{const F=y.imagesFolder,v=`/static/books/${E}/images/${h}/${F}/`,m=Object.keys(d).filter(_=>_.startsWith(v)).map(_=>_.replace("/static","")).sort();return{...y,imageVariants:m}});return{...A,characters:p}});return{book:{id:s.id,slug:s.slug,storyId:s.storyId,productionId:s.productionId,title:k.title,thumbnail:s.thumbnail,origin:k.origin,year:s.year,className:s.className,kindergarten:s.kindergarten||"",createdDate:s.createdDate||"",pageCount:k.pageCount,pages:f,characters:k.characters,credits:k.credits,productionCredits:s.credits}}};function Qa(){return Ae.map(i=>({slug:i.slug}))}const Oo=Object.freeze(Object.defineProperty({__proto__:null,entries:Qa,load:Ja},Symbol.toStringTag,{value:"Module"})),Ka=i=>i;function to(i){const t=i-1;return t*t*t+1}function pe(i){const t=typeof i=="string"&&i.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return t?[parseFloat(t[1]),t[2]||"px"]:[i,"px"]}function eo(i,{delay:t=0,duration:n=400,easing:c=Ka}={}){const s=+getComputedStyle(i).opacity;return{delay:t,duration:n,easing:c,css:b=>`opacity: ${b*s}`}}function ge(i,{delay:t=0,duration:n=400,easing:c=to,x:s=0,y:b=0,opacity:k=0}={}){const E=getComputedStyle(i),h=+E.opacity,d=E.transform==="none"?"":E.transform,f=h*(1-k),[A,p]=pe(s),[y,F]=pe(b);return{delay:t,duration:n,easing:c,css:(v,m)=>`
			transform: ${d} translate(${(1-v)*A}${p}, ${(1-v)*y}${F});
			opacity: ${h-f*m}`}}function fe(i){return--i*i*i*i*i+1}var ao=L('<div class="background-image svelte-17jpt1s"></div>'),oo=L("<img/>"),so=L('<div class="book-page svelte-17jpt1s"><div class="background-layer svelte-17jpt1s"><!></div> <!></div>');function io(i,t){St(t,!0);function n(E){return(t.subtitle.animations?.[E]||"none").split(" ").filter(d=>d!=="none").map(d=>`animate-${d}`).join(" ")}var c=so(),s=o(c),b=o(s);_e(b,()=>t.page.background,E=>{var h=ao();D(d=>Yt(h,`background-image: url(${d??""})`),[()=>rt(t.page.background)]),Xt(1,h,()=>ge,()=>({x:t.direction==="right"?100:-100,duration:800,easing:fe})),Xt(2,h,()=>ge,()=>({x:t.direction==="right"?-100:100,duration:800,easing:fe})),w(E,h)}),a(s);var k=r(s,2);Rt(k,17,()=>t.page.characters,Lt,(E,h,d)=>{var f=Ht(),A=ut(f);{var p=y=>{var F=Ht(),v=ut(F);_e(v,()=>t.selectedImages[d],m=>{var _=oo();D((l,u)=>{O(_,"src",l),O(_,"alt",`キャラクター ${e(h).id??""}`),W(_,1,`character ${u??""}`,"svelte-17jpt1s"),Yt(_,`
          left: ${e(h).position.x??""}%; 
          top: ${e(h).position.y??""}%; 
          --scale: ${e(h).scale??1??""};
					--flip: ${e(h).flip??1??""};
        `)},[()=>rt(t.selectedImages[d]),()=>n(e(h).id)]),Xt(3,_,()=>eo),w(m,_)}),w(y,F)};M(A,y=>{t.selectedImages[d]&&y(p)})}w(E,f)}),a(c),w(i,c),Mt()}var ro=L('<div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">参加人数：</span> <span class="value svelte-1hu0b6n"> </span></div>'),no=L('<div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">イラスト：</span> <span class="value svelte-1hu0b6n"> </span></div> <!>',1),co=L('<p class="notes svelte-1hu0b6n"> </p>'),lo=L('<section class="credits-section production svelte-1hu0b6n"><h3 class="svelte-1hu0b6n">制作</h3> <div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">制作園：</span> <span class="value svelte-1hu0b6n"> </span></div> <div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">クラス：</span> <span class="value svelte-1hu0b6n"> </span></div> <!> <!></section>'),vo=L('<div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">脚色：</span> <span class="value svelte-1hu0b6n"> </span></div>'),mo=L('<section class="credits-section svelte-1hu0b6n"><h3 class="svelte-1hu0b6n">原作・脚本</h3> <div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">原作：</span> <span class="value svelte-1hu0b6n"> </span></div> <!></section>'),uo=L('<div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">背景：</span> <span class="value svelte-1hu0b6n"> </span></div>'),bo=L('<div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">キャラクター：</span> <span class="value svelte-1hu0b6n"> </span></div>'),_o=L('<section class="credits-section svelte-1hu0b6n"><h3 class="svelte-1hu0b6n">ビジュアル</h3> <!> <!></section>'),po=L('<div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">ナレーション：</span> <span class="value svelte-1hu0b6n"> </span></div>'),go=L("<div> </div>"),fo=L('<div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">声：</span> <span class="value svelte-1hu0b6n"></span></div>'),ho=L('<div class="credits-item svelte-1hu0b6n"><span class="label svelte-1hu0b6n">BGM：</span> <span class="value svelte-1hu0b6n"> </span></div>'),wo=L('<section class="credits-section svelte-1hu0b6n"><h3 class="svelte-1hu0b6n">音声</h3> <!> <!> <!></section>'),ko=L('<button class="back-button svelte-1hu0b6n"><iconify-icon></iconify-icon> 絵本に戻る</button>',2),yo=L('<div class="credits-page svelte-1hu0b6n"><div class="credits-header svelte-1hu0b6n"><p class="credits-subtitle svelte-1hu0b6n">さくしゃ、そざいなど</p></div> <div class="credits-content svelte-1hu0b6n"><!> <!> <!> <!></div> <!></div>');function jo(i,t){St(t,!0);const n=t.book.credits?.story,c=t.book.credits?.visuals,s=t.book.credits?.audio,b=t.book.productionCredits;var k=yo(),E=r(o(k),2),h=o(E);{var d=l=>{var u=lo(),U=r(o(u),2),B=r(o(U),2),C=o(B,!0);a(B),a(U);var S=r(U,2),g=r(o(S),2),j=o(g);a(g),a(S);var R=r(S,2);{var x=Y=>{var q=no(),$=ut(q),bt=r(o($),2),Ut=o(bt,!0);a(bt),a($);var Vt=r($,2);{var _t=nt=>{var ct=ro(),Ct=r(o(ct),2),Et=o(Ct);a(Ct),a(ct),D(()=>N(Et,`${b.illustrations.participants??""}名`)),w(nt,ct)};M(Vt,nt=>{b.illustrations.participants&&nt(_t)})}D(()=>N(Ut,b.illustrations.method)),w(Y,q)};M(R,Y=>{b.illustrations&&Y(x)})}var V=r(R,2);{var Z=Y=>{var q=co(),$=o(q,!0);a(q),D(()=>N($,b.notes)),w(Y,q)};M(V,Y=>{b.notes&&Y(Z)})}a(u),D(()=>{N(C,b.production.kindergarten),N(j,`${b.production.year??""}年 ${b.production.class??""}`)}),w(l,u)};M(h,l=>{b&&l(d)})}var f=r(h,2);{var A=l=>{var u=mo(),U=r(o(u),2),B=r(o(U),2),C=o(B,!0);a(B),a(U);var S=r(U,2);{var g=j=>{var R=vo(),x=r(o(R),2),V=o(x,!0);a(x),a(R),D(()=>N(V,n.adaptation)),w(j,R)};M(S,j=>{n.adaptation&&j(g)})}a(u),D(()=>N(C,n.original)),w(l,u)};M(f,l=>{n&&l(A)})}var p=r(f,2);{var y=l=>{var u=_o(),U=r(o(u),2);{var B=g=>{var j=uo(),R=r(o(j),2),x=o(R,!0);a(R),a(j),D(()=>N(x,c.backgrounds)),w(g,j)};M(U,g=>{c.backgrounds&&g(B)})}var C=r(U,2);{var S=g=>{var j=bo(),R=r(o(j),2),x=o(R,!0);a(R),a(j),D(()=>N(x,c.characterDesign)),w(g,j)};M(C,g=>{c.characterDesign&&!b&&g(S)})}a(u),w(l,u)};M(p,l=>{c&&l(y)})}var F=r(p,2);{var v=l=>{var u=wo(),U=r(o(u),2);{var B=R=>{var x=po(),V=r(o(x),2),Z=o(V,!0);a(V),a(x),D(()=>N(Z,s.narration)),w(R,x)};M(U,R=>{s.narration&&R(B)})}var C=r(U,2);{var S=R=>{var x=fo(),V=r(o(x),2);Rt(V,21,()=>s.voice,Lt,(Z,Y)=>{var q=go(),$=o(q,!0);a(q),D(()=>N($,e(Y))),w(Z,q)}),a(V),a(x),w(R,x)};M(C,R=>{s.voice&&R(S)})}var g=r(C,2);{var j=R=>{var x=ho(),V=r(o(x),2),Z=o(V,!0);a(V),a(x),D(()=>N(Z,s.bgm)),w(R,x)};M(g,R=>{s.bgm&&R(j)})}a(u),w(l,u)};M(F,l=>{s&&l(v)})}a(E);var m=r(E,2);{var _=l=>{var u=ko();u.__click=function(...B){t.onClose?.apply(this,B)};var U=o(u);z(U,"icon","mdi:arrow-left"),jt(),a(u),w(l,u)};M(m,l=>{t.onClose&&l(_)})}a(k),w(i,k),Mt()}Jt(["click"]);var Ro=L('<button class="image-card svelte-sdywjb"><img class="svelte-sdywjb"/> <div class="image-number svelte-sdywjb"></div></button>'),Lo=L('<section class="character-section svelte-sdywjb"><h3 class="character-name svelte-sdywjb"> </h3> <div class="image-grid svelte-sdywjb"></div></section>'),Uo=L('<div class="modal-container svelte-sdywjb"><button class="image-modal-backdrop svelte-sdywjb" aria-label="モーダルを閉じる"></button> <div class="modal-content svelte-sdywjb"><button class="close-button svelte-sdywjb" aria-label="閉じる"><iconify-icon></iconify-icon></button> <img alt="拡大画像" class="modal-image svelte-sdywjb"/> <p class="modal-caption svelte-sdywjb"> </p></div></div>',2),Co=L('<button class="back-button svelte-sdywjb"><iconify-icon></iconify-icon> 絵本に戻る</button>',2),Eo=L('<div class="gallery-page svelte-sdywjb"><div class="gallery-header svelte-sdywjb"><p class="gallery-subtitle svelte-sdywjb">みんなが かいたえを みてみよう</p></div> <div class="gallery-content svelte-sdywjb"></div> <!> <!></div>');function xo(i,t){St(t,!0);let n=X(null),c=X(null),s=Nt(()=>{const v=new Map;return t.book.pages.forEach(m=>{m.characters.forEach(_=>{v.has(_.id)||v.set(_.id,new Set),_.imageVariants&&_.imageVariants.forEach(l=>{v.get(_.id).add(l)})})}),Array.from(v.entries()).map(([m,_])=>({id:m,name:b(m),description:k(m),images:Array.from(_).sort()}))});function b(v){return t.book.characters?.[v]?.name||v}function k(v){return t.book.characters?.[v]?.description}function E(v,m){P(n,v,!0),P(c,m,!0)}function h(){P(n,null),P(c,null)}var d=Eo(),f=r(o(d),2);Rt(f,21,()=>e(s),Lt,(v,m)=>{var _=Lo(),l=o(_),u=o(l,!0);a(l);var U=r(l,2);Rt(U,21,()=>e(m).images,Lt,(B,C,S)=>{var g=Ro();g.__click=()=>E(e(C),e(m).id);var j=o(g),R=r(j,2);R.textContent=S+1,a(g),D(x=>{O(g,"aria-label",`${e(m).name??""}の絵 ${S+1}`),O(j,"src",x),O(j,"alt",`${e(m).name??""}の絵`)},[()=>rt(e(C))]),w(B,g)}),a(U),a(_),D(()=>N(u,e(m).name)),w(v,_)}),a(f);var A=r(f,2);{var p=v=>{var m=Uo(),_=o(m);_.__click=h;var l=r(_,2),u=o(l);u.__click=h;var U=o(u);z(U,"icon","mdi:close"),a(u);var B=r(u,2),C=r(B,2),S=o(C);a(C),a(l),a(m),D((g,j)=>{O(B,"src",g),N(S,`${j??""}の絵`)},[()=>rt(e(n)),()=>b(e(c)||"")]),w(v,m)};M(A,v=>{e(n)&&v(p)})}var y=r(A,2);{var F=v=>{var m=Co();m.__click=function(...l){t.onClose?.apply(this,l)};var _=o(m);z(_,"icon","mdi:arrow-left"),jt(),a(m),w(v,m)};M(y,v=>{t.onClose&&v(F)})}a(d),w(i,d),Mt()}Jt(["click"]);var Io=L('<meta name="description"/> <meta property="og:title"/> <meta property="og:image"/> <meta property="og:url"/>',1),Po=L("<a> </a>"),To=L('<div class="book-content svelte-jot9ci"><a class="page-area svelte-jot9ci"><!></a> <div class="subtitle-area svelte-jot9ci"><div class="subtitle-container pc-view svelte-jot9ci"></div> <div class="subtitle-container mobile-view svelte-jot9ci"><a class="subtitle-text active svelte-jot9ci"> </a></div></div></div> <audio></audio> <div class="controls svelte-jot9ci"><div class="subtitle-controls svelte-jot9ci"><button aria-label="前場面" class="svelte-jot9ci"><iconify-icon></iconify-icon></button> <div class="flex gap-2 svelte-jot9ci"><button aria-label="音声有無"><iconify-icon></iconify-icon></button> <button aria-label="オート再生"><iconify-icon></iconify-icon></button> <button class="svelte-jot9ci"><iconify-icon></iconify-icon></button></div> <button aria-label="次場面" class="svelte-jot9ci"><iconify-icon></iconify-icon></button></div> <div class="page-controls svelte-jot9ci"><button aria-label="前ページ" class="svelte-jot9ci"><iconify-icon></iconify-icon></button> <span class="page-indicator svelte-jot9ci"> </span> <div class="progress svelte-jot9ci"> </div> <button aria-label="次ページ" class="svelte-jot9ci"><iconify-icon></iconify-icon></button></div></div>',3),Ao=L('<div class="container"><header class="header svelte-jot9ci"><h1 class="title svelte-jot9ci"> </h1></header> <nav aria-label="パンくずリスト"><ol class="breadcrumb svelte-jot9ci"><li><a href="./">絵本一覧</a></li> <li> </li></ol></nav> <main class="book-viewer svelte-jot9ci"><div class="tab-navigation svelte-jot9ci"><button><iconify-icon></iconify-icon> えほん</button> <button><iconify-icon></iconify-icon> ギャラリー</button> <button><iconify-icon></iconify-icon> さくしゃ</button></div> <!></main></div>',2);function qo(i,t){St(t,!0);const n=t.data.book;let c=X(0),s=X(0),b=X(!0),k=X(0);async function E(){const T=[],I=[];n.pages.forEach(H=>{H.background&&T.push(H.background),H.characters.forEach(G=>{G.imageVariants?.forEach(Q=>{T.push(Q)})}),H.subtitles.forEach(G=>{G.audio&&I.push(G.audio)})});const et=[...new Set(T)],at=[...new Set(I)],ot=et.length,J=et.length+at.length;let K=0;const gt=et.map(H=>new Promise((G,Q)=>{const lt=new Image;lt.onload=()=>{K++,P(k,Math.round(K/ot*100),!0),G()},lt.onerror=()=>{console.warn(`Failed to load image: ${H}`),K++,P(k,Math.round(K/ot*100),!0),G()},lt.src=rt(H)})),st=at.map(H=>new Promise(G=>{const Q=new Audio;Q.oncanplaythrough=Q.onerror=()=>{K++,P(k,Math.round(K/J*100),!0),G()},Q.src=rt(H)}));await Promise.all([...gt,...st])}be(async()=>{await E(),setTimeout(()=>{P(b,!1)},300)});let h=X("right"),d=X(!1),f=X(!0),A=X(!0),p=X(null),y=X("book");const F=De();function v(){g(),P(y,"gallery")}function m(){P(y,"book")}function _(){g(),P(y,"credits")}function l(T){return T.characters.map(I=>!I.imageVariants||I.imageVariants.length===0?(console.warn(`No images for character ${I.id}`),null):I.imageVariants[Math.floor(Math.random()*I.imageVariants.length)])}let u=Nt(()=>n.pages[e(c)]),U=Nt(()=>e(u).subtitles[e(s)]),B=Nt(()=>l(e(u)));async function C(){if(!(!e(p)||!e(f)))try{e(p).pause(),e(p).readyState<2&&await new Promise(T=>{const I=()=>{e(p)?.removeEventListener("canplay",I),T()};e(p)?.addEventListener("canplay",I),setTimeout(()=>{e(p)?.removeEventListener("canplay",I),T()},5e3)}),await e(p).play(),P(d,!0)}catch(T){console.warn("音声再生エラー:",T),P(d,!1)}}function S(){setTimeout(()=>{P(d,!1)},100),e(A)&&(e(s)<e(u).subtitles.length-1?(mt(s),setTimeout(()=>{e(f)&&C()},100)):e(c)<n.pages.length-1&&(mt(c),P(s,0),setTimeout(()=>{e(f)&&C()},100)))}function g(){e(p)&&(e(p).pause(),e(p).currentTime=0,P(d,!1))}function j(){e(d)?g():C()}function R(){g(),e(c)<n.pages.length-1&&(P(h,"right"),mt(c),P(s,0),C(),setTimeout(()=>{e(f)&&C()},100))}function x(){g(),e(c)>0&&(P(h,"left"),mt(c,-1),P(s,0))}function V(){g(),e(s)<e(u).subtitles.length-1&&(mt(s),setTimeout(()=>{e(f)&&C()},100))}function Z(){g(),e(s)>0&&mt(s,-1)}function Y(T){P(s,T,!0),g(),C()}be(()=>{const T=I=>{I.key===" "&&j(),I.key==="ArrowRight"&&V(),I.key==="ArrowLeft"&&Z(),I.key==="ArrowDown"&&R(),I.key==="ArrowUp"&&x(),I.key==="Escape"&&m()};return window.addEventListener("keydown",T),()=>window.removeEventListener("keydown",T)}),Be(()=>{e(p)&&(e(p).pause(),P(p,null))});var q=Ao();ta(T=>{var I=Io(),et=ut(I),at=r(et,2),ot=r(at,2),J=r(ot,2);D(()=>{Qe.title=`${n.title??""} | えほんアワーズ`,O(et,"content",`${n.title??""}の絵本。${n.kindergarten??""} ${n.className??""}の作品。`),O(at,"content",`${n.title??""} | えほんアワーズ`),O(ot,"content",n.thumbnail),O(J,"content",`https://ehon-hours.com/books/${n.slug??""}`)}),w(T,I)});var $=o(q);let bt;var Ut=o($),Vt=o(Ut);a(Ut),a($);var _t=r($,2),nt=o(_t),ct=r(o(nt),2),Ct=o(ct,!0);a(ct),a(nt),a(_t);var Et=r(_t,2),Ot=o(Et),dt=o(Ot);let Qt;dt.__click=m;var ke=o(dt);z(ke,"icon","mdi:book-open-page-variant"),jt(),a(dt);var pt=r(dt,2);let Kt;pt.__click=v;var ye=o(pt);z(ye,"icon","mdi:image-multiple"),jt(),a(pt);var xt=r(pt,2);let te;xt.__click=_;var je=o(xt);z(je,"icon","mdi:information-outline"),jt(),a(xt),a(Ot);var Re=r(Ot,2);{var Le=T=>{jo(T,{get book(){return n},onClose:m})},Ue=T=>{var I=Ht(),et=ut(I);{var at=J=>{xo(J,{get book(){return n},onClose:m})},ot=J=>{var K=To(),gt=ut(K),st=o(gt);O(st,"href",null),st.__click=j;var H=o(st);io(H,{get page(){return e(u)},get subtitle(){return e(U)},get selectedImages(){return e(B)},get direction(){return e(h)}}),a(st);var G=r(st,2),Q=o(G);Rt(Q,21,()=>e(u).subtitles,Lt,(it,Ie,Gt)=>{var vt=Po();O(vt,"href",null),vt.__click=()=>Y(Gt);let ue;var Pe=o(vt,!0);a(vt),D(()=>{ue=W(vt,1,"subtitle-text svelte-jot9ci",null,ue,{active:Gt===e(s),past:Gt<e(s)}),N(Pe,e(Ie).text)}),w(it,vt)}),a(Q);var lt=r(Q,2),It=o(lt);O(It,"href",null),It.__click=j;var Ce=o(It,!0);a(It),a(lt),a(G),a(gt);var Pt=r(gt,2);Te(Pt,it=>P(p,it),()=>e(p));var ee=r(Pt,2),qt=o(ee),ft=o(qt);ft.__click=Z;var ae=o(ft);z(ae,"icon","mdi:chevron-left"),W(ae,1,"icon svelte-jot9ci"),a(ft);var Wt=r(ft,2),ht=o(Wt);ht.__click=()=>P(f,!e(f));let oe;var se=o(ht);D(()=>z(se,"icon",e(f)?"mdi:volume-high":"mdi:volume-off")),W(se,1,"icon svelte-jot9ci"),a(ht);var wt=r(ht,2);wt.__click=()=>P(A,!e(A));let ie;var re=o(wt);z(re,"icon","material-symbols:autoplay"),W(re,1,"icon svelte-jot9ci"),a(wt);var Tt=r(wt,2);Tt.__click=function(...it){(e(d)?g:C)?.apply(this,it)};var ne=o(Tt);D(()=>z(ne,"icon",e(d)?"mdi:pause":"mdi:play")),W(ne,1,"icon svelte-jot9ci"),a(Tt),a(Wt);var At=r(Wt,2);At.__click=V;var ce=o(At);z(ce,"icon","mdi:chevron-right"),W(ce,1,"icon svelte-jot9ci"),a(At),a(qt);var le=r(qt,2),kt=o(le);kt.__click=x;var ve=o(kt);z(ve,"icon","mdi:chevron-left"),W(ve,1,"icon svelte-jot9ci"),a(kt);var zt=r(kt,2),Ee=o(zt);a(zt);var $t=r(zt,2),xe=o($t);a($t);var Dt=r($t,2);Dt.__click=R;var me=o(Dt);z(me,"icon","mdi:chevron-right"),W(me,1,"icon svelte-jot9ci"),a(Dt),a(le),a(ee),D(it=>{N(Ce,e(U).text),O(Pt,"src",it),ft.disabled=e(s)===0,oe=W(ht,1,"svelte-jot9ci",null,oe,{"bg-off":!e(f)}),ie=W(wt,1,"svelte-jot9ci",null,ie,{"bg-off":!e(A)}),O(Tt,"aria-label",e(d)?"一時停止":"再生"),At.disabled=e(s)===e(u).subtitles.length-1,kt.disabled=e(c)===0,N(Ee,`ページ：${e(c)+1} / ${n.pages.length??""}`),N(xe,`ばめん：${e(s)+1} / ${e(u).subtitles.length??""}`),Dt.disabled=e(c)===n.pages.length-1},[()=>rt(e(U).audio)]),ea("ended",Pt,S),w(J,K)};M(et,J=>{e(y)==="gallery"?J(at):J(ot,!1)},!0)}w(T,I)};M(Re,T=>{e(y)==="credits"?T(Le):T(Ue,!1)})}a(Et),a(q),D(()=>{bt=Yt($,"",bt,{"--bg-color":F?.kindergartenColor||"#f8f9fa"}),N(Vt,`${n.title??""} - ${n.className??""}`),N(Ct,n.title),Qt=W(dt,1,"tab-button svelte-jot9ci",null,Qt,{active:e(y)==="book"}),Kt=W(pt,1,"tab-button svelte-jot9ci",null,Kt,{active:e(y)==="gallery"}),te=W(xt,1,"tab-button svelte-jot9ci",null,te,{active:e(y)==="credits"})}),w(i,q),Mt()}Jt(["click"]);export{qo as component,Oo as universal};
