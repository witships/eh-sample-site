import{w as l}from"./H3WrqXj8.js";function o(){const{subscribe:i,update:n}=l({canInstall:!1,isIOS:!1,isStandalone:!1,deferredPrompt:null});let s=!1;return{subscribe:i,initialize:()=>{if(s)return;s=!0;const t=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://"),a=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);n(e=>({...e,isIOS:a,isStandalone:t})),!t&&(window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),n(r=>({...r,canInstall:!0,deferredPrompt:e}))}),a&&n(e=>({...e,canInstall:!0})),window.addEventListener("appinstalled",()=>{n(e=>({...e,canInstall:!1,deferredPrompt:null,isStandalone:!0}))}))},install:async()=>{let t;if(i(r=>{t=r})(),!t)return;if(t.isIOS){alert(`【インストール方法】
1. 画面下部の共有ボタンをタップ
2. 「ホーム画面に追加」を選択`);return}if(!t.deferredPrompt)return;await t.deferredPrompt.prompt();const{outcome:e}=await t.deferredPrompt.userChoice;e==="accepted"&&n(r=>({...r,canInstall:!1,deferredPrompt:null}))}}}const u=o();export{u as p};
